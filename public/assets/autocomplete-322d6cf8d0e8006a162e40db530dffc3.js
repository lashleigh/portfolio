function autocomplete(a,b){function c(){this.preventDefault?(this.preventDefault(),this.stopPropagation()):(this.returnValue=!1,this.cancelBubble=!0)}function d(a){return a.stop||(a.stop=c),a}function e(a,b,c){function e(a){c(d(a||window.event))}typeof a.addEventListener=="function"?a.addEventListener(b,e,!1):a.attachEvent("on"+b,e)}function f(a,b){for(var c=0,d=a.length;c<d;++c)b(a[c])}function g(){function i(d){a.replaceRange(d,{line:b.line,ch:c.start},{line:b.line,ch:c.end})}function q(){if(p)return;p=!0,j.parentNode.removeChild(j)}function r(){i(k.options[k.selectedIndex].text),q(),setTimeout(function(){a.focus()},50)}if(a.somethingSelected())return;var b=a.getCursor(!1),c=a.getTokenAt(b),d=c;/^[\w$_]*$/.test(c.string)||(c=d={start:b.ch,end:b.ch,string:"",state:c.state,className:c.string=="."?"property":null});while(d.className=="property"){d=a.getTokenAt({line:b.line,ch:d.start});if(d.string!=".")return;d=a.getTokenAt({line:b.line,ch:d.start});if(!f)var f=[];f.push(d)}var h=l(c,f);if(!h.length)return;if(h.length==1)return i(h[0]),!0;var j=document.createElement("div");j.className="completions";var k=j.appendChild(document.createElement("select"));window.opera||(k.multiple=!0);for(var m=0;m<h.length;++m){var n=k.appendChild(document.createElement("option"));n.appendChild(document.createTextNode(h[m]))}k.firstChild.selected=!0,k.size=Math.min(10,h.length);var o=a.cursorCoords();j.style.left=o.x+"px",j.style.top=o.yBot+"px",document.body.appendChild(j),h.length<=10&&(j.style.width=k.clientWidth-1+"px");var p=!1;return e(k,"blur",q),e(k,"keydown",function(b){var c=b.keyCode;c==13||c==32?(b.stop(),r()):c==27?(b.stop(),q(),a.focus()):c!=38&&c!=40&&(q(),a.focus(),setTimeout(g,50))}),e(k,"dblclick",r),k.focus(),window.opera&&setTimeout(function(){p||k.focus()},100),!0}function l(c,d){function g(a){a.indexOf(f)==0&&e.push(a)}var e=[],f=c.string.replace(/"|'/g,""),h=/\s+|\{|\}|\(|\)|"|\/|:|;|>|<|=|\]|\[|\.|\+|\-|,|\*|\'|\%/,i=a.getValue()+" "+b.scripts,j=_.uniq(i.split(h).filter(function(a){return a.length>1}).sort()),k=j.indexOf(c.string);k!==-1&&j.splice(k,1);for(var l=0;l<j.length;l++)g(j[l]);return e}a.setOption("onKeyEvent",function(a,b){if(b.keyCode===9)return b.stop(),g()});var h="charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight toUpperCase toLowerCase split concat match replace search".split(" "),i="length concat join splice push pop shift unshift slice reverse sort indexOf lastIndexOf every some filter forEach map reduce reduceRight ".split(" "),j="prototype apply call bind".split(" "),k="break case catch continue debugger default delete do else false finally for function if in instanceof new null return switch throw true try typeof var void while with".split(" ")};